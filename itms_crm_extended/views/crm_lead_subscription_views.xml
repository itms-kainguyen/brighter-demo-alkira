<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <data>
        <record model="ir.ui.view" id="view_subscription_package_popup">
            <field name="name">subscription.package.form.popup</field>
            <field name="model">subscription.package</field>
            <field name="priority">20</field>
            <field name="arch" type="xml">
                <form string="Create Subscription">
                    <group>
                        <group>
                            <field name="partner_id" invisible="1"/>
                            <field name="lead" context="{'default_lead': active_id}" attrs="{'required': True}"/>
    <!--                        <field name="partner_invoice_id"/>-->
    <!--                        <field name="partner_shipping_id"/>-->
                            <field name="date_started"/>
                            <field name="start_date"/>
                            <field name="next_invoice_date"/>
                        </group>
                        <group>

                            <field name="plan_id" attrs="{'required': True}" style="width:60%"/>
                            <field name="to_renew" invisible="1"/>
                            <field name="reference_code" attrs="{'required': True}"/>
                            <field name="recurrence_period_id"/>
                            <field name="analytic_account_id"/>
                            <field name="tag_ids" widget="many2many_tags" options="{'limit': 2, 'create': false, 'create_edit': false}"/>
                            <field name="user_id"/>
                            <field name="company_id"/>
                            <field name="stage_category" invisible="1"/>
                            <field name="invoice_mode" invisible="1"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Subscriptions" name="subscription_products_line">
                            <field name="product_line_ids">
                                <tree string="Product lines" editable="bottom">
                                    <field name="sequence" widget="handle"/>
                                    <field name="product_id" required="1"/>
                                    <field name="uom_catg_id" invisible="1"/>
                                    <field name="product_qty" required="1"/>
                                    <field name="product_uom_id" required="1"/>
                                    <field name="currency_id" invisible="1"/>
                                    <field name="unit_price" required="1"/>
                                    <field name="discount" required="1"/>
                                    <field name="tax_id" widget="many2many_tags"/>
                                    <field name="price_tax" readonly="1"/>
                                    <field name="price_total" readonly="1"/>
                                    <field name="total_amount" readonly="1"/>
                                </tree>
                            </field>

                            <group name="note_group" col="6" class="mt-2 mt-md-0">
                                <group class="oe_subtotal_footer oe_right" colspan="2" name="recurring_total">
                                    <field name="total_recurring_price" widget="monetary"/>
                                    <field name="tax_total" widget="monetary"/>
                                    <field name="currency_id" invisible="1"/>
                                    <field name="total_with_tax" widget="monetary"/>

                                </group>
                            </group>

                        </page>
                    </notebook>
                    <footer>
                        <button string="Save" type="object" name="action_save_subscription" class="oe_highlight"/>
                        <button string="Cancel" class="oe_link" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="crm_lead_subscription_form_view">
            <field name="name">subscription.package.form.lead.inherit</field>
            <field name="model">subscription.package</field>
            <field name="inherit_id" ref="subscription_package.subscription_package_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='partner_id']" position="before">
                    <field name="lead" attrs="{'invisible': [('lead', '=', False)]}"/>
                </xpath>
            </field>
        </record>
    </data>
</odoo>
