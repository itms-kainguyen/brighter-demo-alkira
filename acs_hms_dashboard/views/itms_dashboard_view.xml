<?xml version='1.0' encoding='UTF-8'?>
<odoo>
    <record id="itms_dashboard_kanban_view" model="ir.ui.view">
        <field name="name">ITMS Dashboard</field>
        <field name="model">res.users</field>
        <field name="type">kanban</field>
        <field name="priority">100</field>
        <field name="arch" type="xml">
            <kanban create="false" class="o_kanban_dashboard o_acs_hms_kanban">
                <field name="total_patients"/>
                <field name="total_patients_color"/>
                <field name="total_appointments"/>
                <field name="total_appointments_color"/>
                <field name="total_open_invoice"/>
                <field name="total_open_invoice_amount"/>
                <field name="total_open_invoice_color"/>
                <field name="birthday_patients"/>
                <field name="birthday_employee"/>
                <field name="birthday_color"/>
                <field name="appointment_bar_graph"/>
                <field name="appointment_bar_graph_color"/>
                <field name="patient_line_graph"/>
                <field name="patient_line_graph_color"/>

                <field name="my_total_appointments"/>
                <field name="my_total_appointments_color"/>
                <field name="my_total_patients"/>
                <field name="my_total_patients_color"/>
                <field name="my_avg_wait_time"/>
                <field name="my_avg_cons_time"/>
                <field name="my_avg_time_color"/>
                <field name="my_total_treatments"/>
                <field name="my_total_treatments_color"/>

                <field name="avg_wait_time"/>
                <field name="avg_cons_time"/>
                <field name="avg_time_color"/>
                <field name="total_treatments"/>
                <field name="total_treatments_color"/>
                <field name="total_prescriber"/>

                <field name="physicians_color"/>
                <field name="total_physicians"/>
                <field name="total_course"/>
                <field name="total_branch"/>
                <field name="total_referring_physicians"/>
                <field name="total_shedules"/>
                <field name="total_shedules_color"/>
                <field name="dashboard_data_filter"/>
                <field name="is_physician"/>
                <field name="is_manager"/>
                <field name="appointment_data"/>
                <field name="total_prescription"/>
                <field name="total_protocol"/>
                <field name="total_knowledgebase"/>
                <field name="total_knowledge"/>
                <field name="total_meeting_now"/>
                <field name="total_consent"/>
                <field name="total_emergency"/>
                <field name="total_support"/>
                <field name="total_shop"/>
                <field name="total_prescription_color"/>
                <field name="total_protocol_color"/>
                <field name="total_meeting_now_color"/>
                <field name="total_consent_color"/>
                <field name="total_emergency_color"/>
                <field name="total_support_color"/>
                <field name="total_shop_color"/>
                <field name="total_checklist"/>
                <field name="total_checklist_color"/>
                <templates>

                    <t t-name="acs_dashboard_block">
                        <div t-attf-class="card acs-card card-acs" t-attf-style="border-color:#{acs_record_color}">
                            <a type="object" name="acs_open_dashboard_action"
                               t-attf-context="{'acs_action': '#{acs_record_action}' }">
                                <div class="card-heading"
                                     t-attf-style="border-color:#{acs_record_color}; background-color: #{acs_record_color};">
                                    <div class="row">
                                        <div class="col-3 stat-icon stat-icon">
                                            <i t-attf-class="fa #{acs_record_icon}" aria-label="Info" title="Info"></i>
                                        </div>
                                        <div class="col-9 text-right">
                                            <div class="value">
                                                <span t-esc="acs_field_name"/>
                                            </div>
                                            <div class="title">
                                                <t t-esc="acs_record_lable"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                            <a type="object" name="acs_open_dashboard_action"
                               t-attf-context="{'acs_action': '#{acs_record_action}' }"
                               t-attf-style="color: #{acs_record_color};">
                                <div class="card-footer acs-footer">
                                    <span class="float-start">View Details</span>
                                    <span class="float-end">
                                        <i class="fa fa-arrow-circle-right" aria-label="Info" title="Info"></i>
                                    </span>
                                    <div class="clearfix"></div>
                                </div>
                            </a>
                        </div>
                    </t>

                    <t t-name="acs_dashboard_block_second">
                        <div t-attf-class="card acs-card card-acs" t-attf-style="border-color:#{acs_record_color}">
                            <div class="card-heading"
                                 t-attf-style="border-color:#{acs_record_color}; background-color: #{acs_record_color};">
                                <div class="row">
                                    <div class="col-3 stat-icon">
                                        <i t-attf-class="fa #{acs_record_icon}" aria-label="Info" title="Info"></i>
                                    </div>
                                    <div class="col-9 text-right">
                                        <div class="row">
                                            <div class="col-6 text-center my-auto">
                                                <a type="object" name="acs_open_dashboard_action"
                                                   t-attf-context="{'acs_action': '#{acs_record_action}' }">

                                                    <div class="value big-acs-number">
                                                        <span t-esc="acs_field_name"/>
                                                    </div>
                                                    <div class="title small">
                                                        <t t-esc="acs_record_lable"/>
                                                    </div>
                                                </a>
                                            </div>

                                            <div class="col-6 text-center my-auto">
                                                <a type="object" name="acs_open_dashboard_action"
                                                   t-attf-context="{'acs_action': '#{acs_record2_action}' }">

                                                    <div class="value big-acs-number">
                                                        <span t-esc="acs_field2_name"/>
                                                    </div>
                                                    <div class="title small">
                                                        <t t-esc="acs_record2_lable"/>
                                                    </div>
                                                </a>
                                            </div>
                                        </div>
                                        <hr class="acs-hr"/>
                                        <div class="text-center title">
                                            <t t-esc="acs_lable"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>

                    <t t-name="kanban-box">
                        <div id="acs_hms_dashboard" class="">


                            <div class="row" id="appointment_list" groups="acs_hms.group_hms_receptionist">
                                <div class="col-8 mb32">
                                    <t t-value="JSON.parse(record.appointment_data.raw_value)"
                                       t-set="appointment_data"/>

                                    <div class="card-body">
                                        <div class="row">


                                            <div t-foreach="appointment_data" t-as="line" role="article"
                                                 class="itms_dashboard col-6 o_record_draggable">
                                                <div class="oe_kanban_global_click o_kanban_record_has_image_fill">
                                                    <div class="o_kanban_image_fill_left d-none d-md-block"
                                                         style="background-image:url('/base/static/img/avatar_grey.png')"></div>
                                                    <div class="oe_kanban_details d-flex flex-column justify-content-between">
                                                        <div>
                                                            <strong class="oe_partner_heading">
                                                                <span t-esc="line.name"/>
                                                            </strong>
                                                            <ul>
                                                                <li>
                                                                    <b>Nurse:</b>
                                                                    <span t-esc="line.patient"/>
                                                                </li>
                                                            </ul>
                                                            <span class="oe_kanban_list_many2many">
                                                                <div name="acs_tag_ids"
                                                                     class="o_field_widget o_field_many2many_tags"></div>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>


                                        </div>
                                    </div>

                                </div>

                                <div class="col-4 mb32 itms_dashboard_navigation">
                                    <div class="card card-orange">
                                        <div class="card-body btn-group-vertical">
                                            <button name="Appointment" class="btn btn-primary color-orange btn-lg btn-block mb-3"
                                                    type="button">Appointment
                                            </button>
                                            <button name="Prescription" class="btn btn-primary color-orange btn-lg btn-block mb-3"
                                                    type="button">Prescription
                                            </button>
                                            <button name="Treatment" class="btn btn-primary color-orange btn-lg btn-block mb-3"
                                                    type="button">Treatment
                                            </button>
                                            <button name="Patient" class="btn btn-primary color-orange btn-lg btn-block mb-3"
                                                    type="button">Patient
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div id="loading">
                            <div class="loading-container">
                                <span class="loader"></span>
                            </div>
                        </div>


                        <script type="text/javascript">


                        </script>

                        <style type="text/css">

                        </style>


                    </t>


                </templates>
            </kanban>
        </field>
    </record>

    <!-- POPUP -->
    <record id="view_hms_adverse_event_popup_form" model="ir.ui.view">
        <field name="name">hms.adverse.event.popup.form</field>
        <field name="model">hms.adverse.event</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <field name="patient_id" string="Patient" attrs="{'readonly': [('is_sent', '=', True)]}"/>
                        <field name="chemical_burns_event_boolean" string="Chemical Burns" widget="boolean_toggle"
                               attrs="{'readonly': [('is_sent', '=', True)]}"/>
                        <field name="medication_error_event_boolean" string="Medication Errors" widget="boolean_toggle"
                               attrs="{'readonly': [('is_sent', '=', True)]}"/>
                        <field name="blindness_event_boolean" string="Blindness" widget="boolean_toggle"
                               attrs="{'readonly': [('is_sent', '=', True)]}"/>
                        <field name="infections_event_boolean" string="Infections" widget="boolean_toggle"
                               attrs="{'readonly': [('is_sent', '=', True)]}"/>
                        <field name="allergic_event_boolean" string="Allergic Reactions" widget="boolean_toggle"
                               attrs="{'readonly': [('is_sent', '=', True)]}"/>
                        <field name="branch_id" string="Clinic" attrs="{'readonly': [('is_sent', '=', True)]}"/>
                        <field name="nurse_id" string="Nurse" attrs="{'readonly': [('is_sent', '=', True)]}"/>
                        <field name="nurse_phone" string="Contact" attrs="{'readonly': [('is_sent', '=', True)]}"/>
                        <field name="content" string="Message" widget="text"
                               attrs="{'readonly': [('is_sent', '=', True)]}"/>
                        <field name="is_sent" string="Sent" invisible="1"/>
                    </group>
                </sheet>
                <footer>
                    <button name="send_sms" string="Send" type="object" class="btn btn-primary"/>
                    <button special="cancel" string="Cancel" type="object" class="btn btn-link"/>
                </footer>
            </form>
        </field>
    </record>
    <record id="action_hms_adverse_event_popup" model="ir.actions.act_window">
        <field name="name">Adverse Event Notification</field>
        <field name="res_model">hms.adverse.event</field>
        <field name="view_id" ref="acs_hms_dashboard.view_hms_adverse_event_popup_form"/>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>
    <!-- END POPUP -->
    <record id="view_adverse_event_tree" model="ir.ui.view">
        <field name="name">hms.adverse.event.tree</field>
        <field name="model">hms.adverse.event</field>
        <field name="arch" type="xml">
            <tree string="Adverse Event" create="false" edit="false">
                <field name="patient_id" string="Patient" readonly="1"/>
                <field name="chemical_burns_event_boolean" string="Chemical Burns" widget="boolean_toggle"
                       optional="show" readonly="1"/>
                <field name="medication_error_event_boolean" string="Medication Errors" widget="boolean_toggle"
                       optional="show" readonly="1"/>
                <field name="blindness_event_boolean" string="Blindness" widget="boolean_toggle" optional="show"
                       readonly="1"/>
                <field name="infections_event_boolean" string="Infections" widget="boolean_toggle" optional="show"
                       readonly="1"/>
                <field name="allergic_event_boolean" string="Allergic Reactions" widget="boolean_toggle" optional="show"
                       readonly="1"/>
                <field name="branch_id" string="Clinic" readonly="1"/>
                <field name="nurse_id" string="Nurse" readonly="1"/>
                <field name="nurse_phone" string="Contact" readonly="1"/>
                <field name="create_uid" readonly="1"/>
                <field name="create_date" readonly="1"/>
            </tree>
        </field>
    </record>

    <record id="view_adverse_event_filter" model="ir.ui.view">
        <field name="name">hms.adverse.event.filter</field>
        <field name="model">hms.adverse.event</field>
        <field name="priority" eval="1"/>
        <field name="arch" type="xml">
            <search string="Adverse Event">
                <field name="patient_id"/>
                <field name="branch_id"/>
                <field name="nurse_id"/>
                <separator/>
                <group expand="0" string="Group By">
                    <filter string="Nurse" name="nurse_group" domain="[]" context="{'group_by':'nurse_id'}"/>
                    <filter string="Clinic" name="branch_group" domain="[]" context="{'group_by':'branch_id'}"/>
                    <filter string="Patient" name="patient_group" domain="[]" context="{'group_by':'patient_id'}"/>
                    <separator/>
                    <filter string="Month" name="month_date" context="{'group_by':'create_date:month'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="action_adverse_event" model="ir.actions.act_window">
        <field name="name">Adverse Event</field>
        <field name="res_model">hms.adverse.event</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="acs_hms_dashboard.view_adverse_event_filter"/>
        <field name="domain">[('is_sent','=',True)]</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No Record Found
            </p>
        </field>
    </record>

    <!-- Menu Adverse Event -->
    <menuitem id="menu_adverse_event" name="Adverse Event" sequence="300" action="action_adverse_event"
              groups="acs_hms_base.group_hms_manager" web_icon="acs_hms_base,static/description/icon.png"/>

    <record id="action_itms_dashboard" model="ir.actions.act_window">
        <field name="name">ITMS Dashboard</field>
        <field name="view_mode">kanban</field>
        <field name="view_id" ref="itms_dashboard_kanban_view"></field>
        <field name="usage">menu</field>
    </record>
    
    <menuitem id="itms_dashboard_menu" name="ITMS Dashboard" parent="main_dashboard"
              action="action_itms_dashboard" sequence="10"/>

</odoo>