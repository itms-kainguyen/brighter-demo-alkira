<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright (c) 2016-Present Webkul Software Pvt. Ltd. (<https://webkul.com/>) -->
<!-- See LICENSE file for full copyright and licensing details. -->
<!-- License URL : https://store.webkul.com/license.html/ -->

<odoo>
    <data>
        <template id="inherit_multi_variant_product_quantity" inherit_id="website_sale.product_quantity">
            <xpath expr="//div[contains(@t-attf-class,'css_quantity')]" position="attributes">
                <attribute name="t-if">product.hide_var_list_view or not product.product_variant_ids or len(product.product_variant_ids) == 1</attribute>
            </xpath>
        </template>

        <template id="inherit_website_variant_template" inherit_id="website_sale.product" priority="15">
             <xpath expr="//div[@id='product_details']/form/div[hasclass('js_product')]/t" position="before">
                <div id="variants_list_view_status" t-att-data-variant_list_status="not (product.hide_var_list_view or len(product.product_variant_ids) == 1)"/>
            </xpath>
            <xpath expr="//div[@id='product_details']/form/div[hasclass('js_product')]/div" position="attributes">
                <attribute name="t-if">product.hide_var_list_view or not product.product_variant_ids or len(product.product_variant_ids) == 1</attribute>
            </xpath>
            <xpath expr="//div[@id='product_details']/form/div[hasclass('js_product')]/t" position="replace">
                <t t-placeholder="select">
                    <t t-set="product_possible_variants" t-value="product.get_product_possible_variants()"/>
                    <t t-set="is_dynamic_or_never_variant" t-value="product.has_dynamic_or_never_attributes()"/>
                    <t t-if="(product.hide_var_list_view or not product.product_variant_ids or len(product.product_variant_ids) == 1) or not product_possible_variants or is_dynamic_or_never_variant">
                        <input type="hidden" class="product_id" name="product_id" t-att-value="product_variant.id" />
                        <input type="hidden" class="product_template_id" name="product_template_id" t-att-value="product.id" />
                        <t t-set="combination" t-value="product_combination if product_combination else product._get_first_possible_combination()"/>
                        <t t-if="combination" t-call="sale.variants">
                            <t t-set="ul_class" t-value="'flex-column'" />
                            <t t-set="parent_combination" t-value="None" />
                        </t>
                        <t t-else="">
                            <ul class="d-none js_add_cart_variants" t-att-data-attribute_exclusions="{'exclusions: []'}"/>
                        </t>
                    </t>
                    <t t-else="">
                        <table class="table table-striped table-condensed" id="p_variants">
                            <thead>
                                <tr>
                                    <th width="100">Attributes</th>
                                    <th></th>
                                    <th width="115" class="text-center">Price</th>
                                    <th width="67" class="text-center">Quantity</th>
                                    <th width="115" class="text-center">Subtotal</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="product_possible_variants" t-as="variant_id">
                                <t t-set="website_price" t-value="variant_id._get_combination_info_variant(add_qty=add_qty, pricelist=pricelist)"/>

                                    <tr class="p_variants">
                                        <input type="hidden" class="product_id" name="product_id" t-att-value="variant_id.id" />
                                        <td colspan="2">
                                            <t t-if="variant_id.product_template_attribute_value_ids" t-foreach="variant_id.product_template_attribute_value_ids" t-as="p_attribute_value">
                                                <div>
                                                    <span><t t-out="p_attribute_value.attribute_id.name"/>: </span>
                                                    <span><t t-out="p_attribute_value.name"/></span>
                                                    <t t-if="p_attribute_value.is_custom">
                                                        <input type="text" t-att-data-attribute_value_id="p_attribute_value.id" t-att-data-attribute_value_name="p_attribute_value.name" class="variant_custom_value form-control custom_value_radio p_variants_cust_val" t-att-name="p_attribute_value.name"/>
                                                    </t>
                                                </div>
                                            </t>
                                            <t t-if="not variant_id.product_template_attribute_value_ids">
                                                <div>
                                                    <span><t t-out="variant_id.name"/></span>
                                                </div>
                                            </t>
                                        </td>
                                        <td class="text-center" id="var-price">
                                            <div class="decimal_precision" t-att-data-precision="str(product.currency_id.decimal_places)"/>
                                            <span t-out="website_price['price']"
                                                t-options='{
                                                "widget": "monetary",
                                                "display_currency": website.get_current_pricelist().currency_id,
                                                }'/>
                                        </td>
                                        <td class="text-center" id="var-qty">
                                            <div class="css_quantity input-group oe_website_spinner" contenteditable="false">
                                                <input type="text" class="form-control text-center quantity" data-min="0" name="add_qty" t-att-value="1 if variant_id.id == product_possible_variants[0].id else '0'" autocomplete="off" style="min-width: 48px;"/>
                                                <div class="multi_variants_button">

                                                    <div class="input-group-append">
                                                        <a t-attf-href="#" class="btn btn-link float_left js_add_cart_json d-none d-md-inline-block" aria-label="Add one" title="Add one">
                                                            <i class="fa fa fa-chevron-up"></i>
                                                        </a>
                                                    </div>
                                                    <div class="input-group-prepend">
                                                        <a t-attf-href="#" class="btn btn-link js_add_cart_json d-none d-md-inline-block" aria-label="Remove one" title="Remove one">
                                                            <i class="fa fa fa-chevron-down"></i>
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="text-center" id="var-subtotal">
                                            <t t-set="subtotal" t-value="website_price['price'] if variant_id.id == product_possible_variants[0].id else '0'"/>
                                            <t t-out="float(subtotal)"
                                                t-options='{
                                                "widget": "monetary",
                                                "display_currency": website.get_current_pricelist().currency_id,
                                                }'/>
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                        <div id="multi-variant-error" class="text-center alert alert-danger" style="display:none;padding: 8px;">
                            <span>No product will be selected</span>
                        </div>
                        <div class="text-right float-end text-muted" id="var-total-price" style="font-size: 20px;">
                            <t t-set="website_price" t-value="product.product_variant_ids[0]._get_combination_info_variant(add_qty=add_qty, pricelist=pricelist)"/>
                            <t t-set="total_price" t-value="website_price['price'] if product_possible_variants else '0'"/>
                            <span style="margin-right: 20px;">Total:</span>
                            <t t-out="float(total_price)"
                                t-options='{
                                "widget": "monetary",
                                "display_currency": website.get_current_pricelist().currency_id,
                                }'/>
                        </div>
                    </t>
                </t>
            </xpath>
        </template>
    </data>
</odoo>
