<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">

        <record id="acs_appointment_email" model="mail.template">
            <field name="name">Appointment Creation</field>
            <field name="email_from">{{  user.email }}</field>
            <field name="email_to">{{ object.patient_id.email }}</field>
            <field name="subject">{{ object.patient_id.name }} Your Appointment has been scheduled</field>
            <field name="model_id" ref="acs_hms.model_hms_appointment"/>
            <field name="report_template" ref="acs_hms.action_appointment_report"/>
            <field name="report_name">{{ (object.name or '').replace('/','_') }}</field>
            <field name="lang">{{ object.patient_id.lang }}</field>
             <field name="auto_delete" eval="False"/>
            <field name="body_html" type="html">
<div style="margin:auto;background: #FFFFFF;color:#777777">
    <t t-set="appointment_date" t-value="format_datetime(dt=object.date, tz=object.physician_id.tz or 'UTC', lang_code=object.physician_id.lang)"/>
    <p>Hello <t t-out="object.patient_id.name"/>,</p>
    <p>Your Appointment has been scheduled with following details.</p>
    <ul> 
        <li>
            <p>Subject: <t t-out="object.purpose_id.name"/></p>
        </li>
        <li>
            <p>Reference Number: <t t-out="object.name"/></p>
        </li>
        <li>
            <p>Nurse Name: <t t-out="object.nurse_id.name"/></p>
        </li>
        <li>
            <p>Date &amp; Time: <t t-out="appointment_date or ''"/> (Timezone: <t t-out="object.physician_id.tz or 'UTC'"/>)</p>
        </li>
    </ul>
    <p>Please feel free to call anytime for further information or any query.</p>

    <p>Best regards.</p><br/>
</div>
                
            </field>
        </record>

        <record id="acs_prescription_email" model="mail.template">
            <field name="name">Prescription Creation</field>
            <field name="email_from">{{ user.email }}</field>
            <field name="email_to">{{ object.patient_id.email }}</field>
            <field name="subject">{{ object.patient_id.name }} Your Prescription</field>
            <field name="model_id" ref="acs_hms.model_prescription_order"/>
            <field name="report_template" ref="acs_hms.report_hms_prescription_id"/>
            <field name="report_name">{{ (object.name or '').replace('/','_') }}</field>
            <field name="lang">{{ object.patient_id.lang }}</field>
            <field name="auto_delete" eval="True"/>
            <field name="body_html" type="html">
<div style="padding:0px;width:600px;margin:auto;background: #FFFFFF repeat top /100%;color:#777777">
    <p>Hello <t t-out="object.patient_id.name"/>,</p>
    <p>Your Prescription details. For more details please refer attached PDF report.</p>
    <ul>
        <li>
            <p>Reference Number: <t t-out="object.name"/></p>
        </li>
        <li t-if="object.appointment_id">
            <p>Appointment ID: <t t-out="object.appointment_id.name"/></p>
        </li>
        <li t-if="object.physician_id">
            <p>Physician Name: <t t-out="object.physician_id.name"/></p>
        </li>
        <li>
            <p>Prescription Date: <t t-out="object.prescription_date"/></p>
        </li>
    </ul>
    <p>Please feel free to call anytime for further information or any query.</p>

    <p>Best regards.</p><br/>
</div>
  
            </field>
        </record>

         <record id="appointment_consent_form_email" model="mail.template">
            <field name="name">Consent Form ITMS</field>
            <field name="model_id" ref="acs_hms.model_hms_appointment"/>
            <field name="auto_delete" eval="False"/>
            <field name="description">Consent Form</field>
            <field name="lang">{{ object.patient_id.lang }}</field>
           <field name="email_from">{{ (object.nurse_id.email or user.email_formatted or object.user_id.login) }}</field>
            <field name="email_to">{{ (object.patient_id.email) }}</field>
            <field name="subject">Accept and Sign for {{ object.name }}</field>
            <field name="body_html" type="html">
                <div style="margin: 0px; padding: 0px;">
                    <p>Dear <t t-out="object.patient_id.name"></t>,</p>
                    <p></p>
                    <p>In preparation for your upcoming appointment, we kindly request that you click on the following link to access and electronically sign our consent form</p>
                        <div style="padding: 16px 0px 16px 0px;">
                            <t t-foreach="object.consent_ids" t-as="consent_id">
                                <a t-att-href="consent_id.get_portal_url()"
                                    target="_blank"
                                    style="background-color: #875a7b; text-decoration: none; color: #fff; padding: 8px 16px 8px 16px; border-radius: 5px;"><t t-out="consent_id.name"></t></a>

                            </t>
                        </div>
                    <br/>
                    <p>Kind regards,</p>
                </div>
            </field>
        </record>

        <record id="consent_appointment_form_email" model="mail.template">
            <field name="name">Consent Form ITMS</field>
            <field name="model_id" ref="acs_hms.model_hms_appointment"/>
            <field name="auto_delete" eval="False"/>
            <field name="description">Consent Form</field>
            <field name="lang">{{ object.patient_id.lang }}</field>
           <field name="email_from">{{ (object.nurse_id.email or user.email_formatted or object.user_id.login) }}</field>
            <field name="email_to">{{ (object.patient_id.email) }}</field>
            <field name="subject">Accept and Sign for {{ object.name }}</field>
            <field name="body_html" type="html">
                <div style="margin: 0px; padding: 0px;">
                    <p>Dear <t t-out="object.patient_id.name"></t>,</p>
                    <p></p>
                    <p>In preparation for your upcoming appointment, we kindly request that you click on the following link to access and electronically sign our consent form</p>
                        <div style="padding: 16px 0px 16px 0px;">
                              <a t-att-href="ctx.get('itms_consent_id').get_portal_url()"
                                    target="_blank"
                                    style="background-color: #875a7b; text-decoration: none; color: #fff; padding: 8px 16px 8px 16px; border-radius: 5px;"><t t-out="ctx.get('itms_consent_id').name"></t></a>
                        </div>
                    <br/>
                    <p>Kind regards,</p>
                </div>
            </field>
        </record>

        <record id="email_template_prescription_reminder" model="mail.template">
            <field name="name">Prescription Reminder</field>
            <field name="model_id" ref="acs_hms.model_prescription_detail"/>
            <field name="auto_delete" eval="False"/>
            <field name="description">Prescription Reminder</field>
            <field name="email_from">{}</field>
            <field name="email_to">{{ (object.prescription_id.patient_id.email_formatted) }}</field>
            <field name="subject">Reminder</field>
            <field name="lang">{{ object.prescription_id.patient_id.lang }}</field>
            <field name="body_html" type="html">
                <div style="margin: 0px; padding: 0px;">
                    <p>Dear <t t-out="object.prescription_id.patient_id.name"></t>,</p>
                    <p></p>
                    <p>This is a friendly reminder that you have a prescribed medication scheduled in a few days, details:
                    <br/><br/>
                    <t t-set="ids" t-value="(ctx.get('lines'))"/>
                    <t t-set="records" t-value="object.sudo().browse(list(ids))"/>
                    <t t-foreach="records" t-as="line">
                        <t t-if="line and line.product_id">
                            <t t-out="line.product_id.display_name"/><br/>
                        </t>
                    </t>
                    <br/>
                    To ensure your continued care, we recommend scheduling an appointment with your healthcare provider.

                    Please feel free to contact us if you have any questions or need assistance.
                    </p>
                    <p>Kind regards,</p>
                </div>
            </field>
        </record>


        <record id="appointment_aftercare_email" model="mail.template">
            <field name="name">Aftercare</field>
            <field name="model_id" ref="acs_hms.model_hms_appointment"/>
            <field name="auto_delete" eval="False"/>
            <field name="description">Aftercare</field>
            <field name="email_from">{{ (object.nurse_id.email or user.email_formatted) }}</field>
            <field name="email_to">{{ object.patient_id.email }}</field>
            <field name="subject">Aftercare</field>
            <field name="lang">{{ object.patient_id.lang }}</field>
            <field name="body_html" type="html">
                <div style="margin: 0px; padding: 0px;">
                    <p>Dear <t t-out="object.patient_id.name"></t>,</p>
                    <p>Thank you for choosing <strong><t t-out="object.department_id.name"></t></strong> for your recent cosmetic treatment.</p>
                    <p>Your treatment included:</p>
                    <table class="table table-sm o_main_table mt16 acs_table">
                        <thead>
                            <tr>
                                <th>Medicine</th>
                                <th>Area</th>
                                <th>Amount</th>
                                <th>Technique</th>
                                <th>Depth</th>
                                <th>Method</th>
                            </tr>
                        </thead>
                        <tbody>
                        <t t-if="len(ctx.get('medicine_line_ids')) > 0">
                            <t t-foreach="ctx.get('medicine_line_ids')" t-as="line">
                                <tr>
                                    <td>
                                        <span t-out="line.get('product_name')"/>
                                    </td>
                                    <td>
                                        <span t-out="line.get('medicine_area')"/>
                                    </td>
                                    <td>
                                        <span t-out="line.get('amount')"/>
                                    </td>
                                    <td>
                                        <span t-out="line.get('medicine_technique')"/>
                                    </td>
                                    <td>
                                        <span t-out="line.get('medicine_depth')"/>
                                    </td>
                                    <td>
                                        <span t-out="line.get('medicine_method')"/>
                                    </td>
                                </tr>
                            </t>
                        </t>
                    </tbody>
                    </table>
                     <t t-if="len(ctx.get('treatment_notes')) > 0">
                        <t t-foreach="ctx.get('treatment_notes')" t-as="note">
                            <p>
                                Treatment Notes: <strong><t t-out="note.get('template')"></t></strong>
<!--                                <p><t t-out="note.get('finding')"></t></p>-->
                            </p>
                        </t>
                     </t>
                    <style>
                        table.table.table-sm.o_main_table.mt16.acs_table th, td, tbody { border: 1px solid black !important; }
                    </style>
                    <p>
                        We hope you had a pleasant experience. Please find attached important post-treatment instructions to ensure optimal results.
                        Should you have any questions or concerns, feel free to reach out to us at <strong><t t-out="object.department_id.name"></t></strong>.
                        We look forward to assisting you in your aesthetic journey.
                    </p>
                    <br/>
                    <p>Kind regards,</p>
                </div>
            </field>
        </record>

    </data>
</odoo>
